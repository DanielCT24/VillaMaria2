<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> I.E.P. VILLA MARA</title>
    <script src="js/JS - Principal.js"></script>
    <script src="js/JS - Carrito.js"></script>
    <link rel="stylesheet" href="css/CSS - Carrito.css">
    </link>
    <link rel="stylesheet" href="css/CSS - Checkout.css">
    <link rel="icon" sizes="180x180" href="ICON/android-chrome-192x192.webp">
    <link rel="icon" type="image/png" sizes="32x32" href="ICON/favicon-32x32.webp">
    <link rel="icon" type="image/png" sizes="16x16" href="ICON/favicon-16x16.webp">
    <link rel="manifest" href="site.webmanifest">
    <script src="https://kit.fontawesome.com/21bc0e3a65.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<style>

    /* -------------------------------------------ANIMCACIN HEADER----------------------------------------------- */
    .header-nav a {
        position: relative;
        text-decoration: none;
        /* Elimina el subrayado por defecto */
        color: #fff;
        /* Cambia esto seg煤n el color de tu dise帽o */
        padding: 10px;
        display: inline-block;
    }

    .header-nav a::after {
        content: "";
        position: absolute;
        width: 0;
        height: 1px;
        background-color: #50026e;
        /* Cambia esto seg煤n el color de la l铆nea que quieras */
        left: 50%;
        bottom: 0;
        transition: all 0.3s ease;
        transform: translateX(-50%);
    }

    .header-nav a:hover::after {
        width: 100%;
    }
</style>

<body>

    <!-- Header - menu -->
    <header>
        <div class="menu ">
            <a href="/"><img class="logo-1 " src="/header-body/logo.webp" alt=""></a>
            <input type="checkbox" id="menu">
            <label for="menu">
                <img src="/header-body/menu.webp" loading="lazy" class="menu-icono">
                <a href="/Usuario" class="btn__login">
                    <img src="/header-body/Imagen-Login.webp" alt="Login" loading="lazy" class="login-icon">
                    <h3 class="userDNI" id="userDNI">Nombre del Usuario</h3>
                </a>
            </label>

            <nav class="navbar fade-in">
                <div class="menu-1 fade-in">
                    <div class="containermenu">

                        <ul>
                            <li><a href="/">Inicio</a></li>
                            <li><a href="/#ofertas">Ofertas</a></li>
                            <li><a href="/header-body/CATLOGO I.E.P. VILLA MARA.pdf">Cat谩logo</a></li>
                            <li><a href="https://maps.app.goo.gl/dawTfqAEDtirWpCu5">Env铆o</a></li>
                        </ul>
                    </div>
                </div>

                <!------------------------------------- PC ------------------------------------->

                <a href="/"><img class="logo-2 " src="/header-body/logo.webp" alt=""></a>

                <a href="/Usuario" class="btn__login" id="loginButton">
                    <img src="/header-body/Imagen-Login.webp" alt="Login" loading="lazy" class="login-icon-header">
                    <h3 class="userNamesPC" id="userNames">Nombre del Usuario</h3>

                </a>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- Formulario de Informaci贸n de Env铆o -->
            <div class="shipping-info">
                <h2>Informaci贸n de Env铆o</h2>
                <form id="paymentForm">
                    <div class="section">
                        <label> DIRECCIN</label>
                        <div class="search-container">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="Digite Su Departamento..." required>
                                <div class="search-icon">&#128269;</div>
                            </div>
                            <div class="dropdown-menu" id="dropdownMenu">
                                <!-- Opciones ser谩n agregadas din谩micamente con JavaScript -->
                            </div>
                        </div>

                        <input type="text" id="street" placeholder="Calle y N煤mero (*Obligatorio)" required>
                        <input type="text" id="apartment" placeholder="Dpto, Oficina, etc. (*Opcional)">
                        <input type="text" id="postal-code" placeholder="C贸digo Postal (*Opcional)">
                        <input type="text" id="alias" placeholder="Referencia (*Opcional)">
                    </div>

                    <div class="delivery-container">
                        <label for="delivery">SELECCIONE UNA OPCIN DE ENVO DELIVERY</label>
                        <div class="delivery-option" required>
                            <label>
                                <input type="radio" name="delivery" value="marvisur" required>
                                Marvisur <span class="info-icon">  </span>
                            </label>
                            <span class="delivery-date">Tu pedido llegar谩 entre el <span id="start-date1"></span> y
                                <span id="end-date1"></span></span>
                        </div>
                        <div class="delivery-option" required>
                            <label>
                                <input type="radio" name="delivery" value="olvacourier" required>
                                OlvaCourier <span class="info-icon">  </span>
                            </label>
                            <span class="delivery-date">Tu pedido llegar谩 entre el <span id="start-date2"></span> y
                                <span id="end-date2"></span></span>
                        </div>
                        <div class="delivery-option" required>
                            <label>
                                <input type="radio" name="delivery" value="shalom" required>
                                Shalom <span class="info-icon">  </span>
                            </label>
                            <span class="delivery-date">Tu pedido llegar谩 entre el <span id="start-date3"></span> y
                                <span id="end-date3"></span></span>
                        </div>
                    </div>

                    <!-- Informaci贸n de Contacto -->
                    <div class="section">
                        <label for="email">INFORMACIN DE CONTACTO</label>
                        <input type="email" id="email" placeholder="Correo electr贸nico" required>
                        <div class="name-fields">
                            <input type="text" id="first-name" placeholder="Nombres" required>
                            <input type="text" id="last-name" placeholder="Apellidos" required>
                        </div>
                        <div class="phone-fields">
                            <span class="flag-icon">叼</span>
                            <input type="tel" id="phone" placeholder="+51 999 999 999" maxlength="9" required>

                        </div>
                        <input type="text" id="dni" placeholder="DNI" maxlength="8" required>
                    </div>

                    <!-- Cup贸n de Descuento -->
                    <div class="section">
                        <label for="coupon">CUPN DE DESCUENTO</label>
                        <input type="text" id="coupon" placeholder="Ingresa tu cup贸n">
                        <button type="button" id="validateCoupon">Validar Descuento</button>
                    </div>

                    <!-- M茅todo de Pago -->
                    <div class="section">
                        <label>SELECCIONA MEDIO DE PAGO</label>
                        <div class="payment-methods" required>
                            <label>
                                <input type="radio" name="payment" value="yape" required>
                                <img class="pagoyape-img" src="img/footer/niubiz.avif" loading="lazy" alt="Yape">
                            </label>
                        </div>
                    </div>

                    <div id="yape-popup" class="popup">
                        <div class="popup-content">
                            <span class="close-btn" onclick="closePopup('yape-popup')">&times;</span>
                            <h2 class="txt-ventana">PAGO CON BANCAS MVILES</h2>
                            <p>Gracias por su compra</p>
                            <div class="yape-number">I.E.P. VILLA MARA</div>
                            <img src="/img/QR.jpg" loading="lazy" alt="QR Code" class="qr-code">
                            <p>Total a pagar</p>
                            <div class="summary-total">
                                <p id="summaryTotalGeneral2">Total S/ 0.00</p>
                            </div>
                            <div class="form-group">
                                <label for="operacion">Digita tu nro. de operaci贸n:</label>
                                <input type="text" id="operacion" class="input-field" oninput="validateForm()">
                            </div>
                            <div class="form-group">
                                <label for="confirma-operacion">Confirma tu nro. de operaci贸n:</label>
                                <input type="text" id="confirma-operacion" class="input-field" oninput="validateForm()">
                            </div>
                            <p id="error-message" class="error-message"></p>
                            <div class="form-group">
                                <label for="fecha-hora">Fecha y hora de la operaci贸n:</label>
                                <input type="datetime-local" id="fecha-hora" class="input-field"
                                    onchange="validateForm()">
                            </div>
                            <p class="warning">- La fecha y hora son requeridas</p>

                            <!-- Adjuntar comprobante -->
                            <input type="file" id="comprobante" class="input-file" onchange="handleFileUpload()">
                            <label for="comprobante" class="upload-btn" id="upload-label"> Adjuntar
                                comprobante</label>
                            <button id="finalize-btn" class="finalize-btn" disabled
                                onclick="finalizePurchase('隆Tu compra ha sido exitosa!')">Finalizar</button>
                        </div>

                        <!-- Modal -->
                        <div id="customModal" class="custom-modal">
                            <div class="custom-modal-content">
                                <span class="custom-close" onclick="closeModal()">&times;</span>
                                <div class="custom-modal-body">
                                    <div class="checkmark-wrapper">
                                        <div class="checkmark-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                                <path
                                                    d="M20.285 6.711l-11.504 11.39-5.393-5.428-1.456 1.458 6.85 6.938 12.963-12.846-1.456-1.464z" />
                                            </svg>
                                        </div>
                                    </div>
                                    <p id="modalMessage">隆Felicidades por tu compra!</p>
                                    <p id="modalMessage">Revisa tu Cuenta</p>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- T茅rminos y Condiciones -->
                    <div class="section">
                        <label>
                            <input type="checkbox" id="terms" required>
                            He le铆do y acepto los <a href="#" id="openTermsModal">t茅rminos y condiciones</a>
                        </label>
                        <label>
                            <input type="checkbox" id="privacy" required>
                            He le铆do y acepto la <a href="#" id="openPrivacyModal">pol铆tica de privacidad de datos</a>
                        </label>
                    </div>

                    <!-- Modal para T茅rminos y Condiciones -->
                    <div id="termsModal" class="modal-checkout modal-terms">
                        <div class="modal-content-checkout">
                            <span class="close-checkout" id="closeTerms">&times;</span>
                            <h1 class="terminos">T茅rminos y Condiciones</h1>
                            <p class="terminos">Al utilizar este sitio web, aceptas cumplir con los siguientes t茅rminos
                                y condiciones. Si no est谩s de acuerdo con alguna parte de estos t茅rminos, te
                                recomendamos que no utilices este sitio.</p>
                            <h2 class="terminos">1. Aceptaci贸n de los T茅rminos</h2>
                            <p class="terminos">Estos t茅rminos y condiciones rigen el uso de este sitio web. Al acceder
                                o utilizar el sitio, aceptas estar sujeto a estos t茅rminos. Si no aceptas estos
                                t茅rminos, no debes usar el sitio.</p>
                            <h2 class="terminos">2. Cambios en los T茅rminos</h2>
                            <p class="terminos">Nos reservamos el derecho de modificar estos t茅rminos en cualquier
                                momento. Cualquier cambio ser谩 efectivo inmediatamente despu茅s de su publicaci贸n en el
                                sitio. Te recomendamos que revises estos t茅rminos peri贸dicamente para estar al tanto de
                                cualquier modificaci贸n.</p>
                            <h2 class="terminos">3. Uso del Sitio</h2>
                            <p class="terminos">El usuario se compromete a usar el sitio de acuerdo con las leyes
                                aplicables y no utilizar el sitio para fines ilegales o prohibidos. Est谩 prohibido el
                                uso de t茅cnicas de "scraping" o cualquier otra forma de recolecci贸n automatizada de
                                datos.</p>
                            <h2 class="terminos">4. Propiedad Intelectual</h2>
                            <p class="terminos">Todo el contenido del sitio, incluidos, entre otros, textos, gr谩ficos,
                                logotipos y software, es propiedad de la empresa o sus licenciantes y est谩 protegido por
                                las leyes de propiedad intelectual. Queda prohibida la reproducci贸n o distribuci贸n del
                                contenido sin autorizaci贸n.</p>
                            <h2 class="terminos">5. Limitaci贸n de Responsabilidad</h2>
                            <p class="terminos">La empresa no ser谩 responsable de ning煤n da帽o directo, indirecto,
                                incidental o consecuente que resulte del uso o la imposibilidad de uso del sitio. Esto
                                incluye, pero no se limita a, da帽os por p茅rdida de beneficios, interrupci贸n del negocio
                                o p茅rdida de informaci贸n.</p>
                            <h2 class="terminos">6. Enlaces a Terceros</h2>
                            <p class="terminos">Este sitio puede contener enlaces a sitios web de terceros. No somos
                                responsables del contenido de estos sitios ni de sus pol铆ticas de privacidad. Te
                                recomendamos que leas las pol铆ticas de privacidad de cada sitio que visites.</p>
                            <h2 class="terminos">7. Legislaci贸n Aplicable</h2>
                            <p class="terminos">Estos t茅rminos se regir谩n e interpretar谩n de acuerdo con las leyes del
                                pa铆s donde se encuentra la empresa, sin dar efecto a sus principios sobre conflictos de
                                leyes.</p>
                            <h2 class="terminos">8. Contacto</h2>
                            <p class="terminos">Si tienes preguntas sobre estos t茅rminos, puedes ponerte en contacto con
                                nosotros a trav茅s del correo electr贸nico: soporte@ejemplo.com.</p>
                            <h2 class="terminos">9. Aceptaci贸n de los T茅rminos</h2>
                            <p class="terminos">El uso continuado de este sitio tras la publicaci贸n de cambios en los
                                t茅rminos implica la aceptaci贸n de dichos cambios.</p>
                            <h2 class="terminos">10. Terminaci贸n</h2>
                            <p class="terminos">Nos reservamos el derecho a cancelar o restringir el acceso al sitio en
                                cualquier momento y por cualquier raz贸n, sin previo aviso.</p>
                            <h2 class="terminos">11. Limitaciones de Uso</h2>
                            <p class="terminos">El usuario se compromete a no realizar actividades que puedan da帽ar,
                                desactivar, sobrecargar o perjudicar el sitio, o interferir con el uso del sitio por
                                parte de otros usuarios. Se proh铆be el uso del sitio para transmitir cualquier contenido
                                ilegal, da帽ino, amenazante o acosador.</p>
                            <h2 class="terminos">12. Indemnizaci贸n</h2>
                            <p class="terminos">El usuario acepta indemnizar y mantener indemne a la empresa, sus
                                afiliados, empleados y agentes de cualquier reclamaci贸n, demanda o p茅rdida, incluyendo
                                honorarios razonables de abogados, que surja del uso del sitio por parte del usuario o
                                de su violaci贸n de estos t茅rminos.</p>
                            <h2 class="terminos">13. Responsabilidad de Contenido</h2>
                            <p class="terminos">La empresa no asume ninguna responsabilidad por el contenido generado
                                por los usuarios o por el contenido de terceros que pueda aparecer en el sitio. Los
                                usuarios son responsables de sus propias publicaciones y de cualquier da帽o que pueda
                                resultar de ellas.</p>
                            <h2 class="terminos">14. Pol铆tica de Cookies</h2>
                            <p class="terminos">Este sitio utiliza cookies para mejorar la experiencia del usuario. Las
                                cookies son peque帽os archivos de texto que se almacenan en tu dispositivo al visitar un
                                sitio web. Puedes optar por no aceptar cookies, pero esto puede afectar tu capacidad
                                para utilizar el sitio de manera efectiva.</p>
                            <h2 class="terminos">15. Fuerza Mayor</h2>
                            <p class="terminos">No seremos responsables de ninguna falla o retraso en el cumplimiento de
                                nuestras obligaciones en virtud de estos t茅rminos si dicha falla o retraso se debe a
                                causas ajenas a nuestro control razonable, incluyendo, pero no limit谩ndose a, actos de
                                Dios, guerras, embargos, disturbios o desastres naturales.</p>
                            <h2 class="terminos">16. Disposiciones Generales</h2>
                            <p class="terminos">Si alguna disposici贸n de estos t茅rminos se considera inv谩lida o
                                inaplicable, las dem谩s disposiciones seguir谩n siendo v谩lidas y aplicables. Estos
                                t茅rminos constituyen el acuerdo completo entre el usuario y la empresa con respecto al
                                uso del sitio.</p>
                            <h2 class="terminos">17. Modificaciones</h2>
                            <p class="terminos">La empresa se reserva el derecho de modificar estos t茅rminos en
                                cualquier momento. Cualquier modificaci贸n ser谩 efectiva inmediatamente despu茅s de su
                                publicaci贸n en el sitio. El uso continuado del sitio tras la publicaci贸n de cambios en
                                los t茅rminos implica la aceptaci贸n de dichos cambios.</p>
                            <h2 class="terminos">18. Derechos Reservados</h2>
                            <p class="terminos">Todos los derechos no expresamente otorgados en estos t茅rminos son
                                reservados por la empresa. Cualquier uso no autorizado del sitio o de su contenido puede
                                ser objeto de acci贸n legal.</p>
                            <p class="terminos">Estos t茅rminos y condiciones fueron actualizados por 煤ltima vez el
                                28/09/2024. Te agradecemos tu comprensi贸n y cooperaci贸n.</p>
                        </div>
                    </div>

                    <!-- Modal para Pol铆tica de Privacidad -->
                    <div id="privacyModal" class="modal-checkout modal-privacy">
                        <div class="modal-content-checkout">
                            <span class="close-checkout" id="closePrivacy">&times;</span>
                            <h1 class="terminos">Pol铆tica de Privacidad</h1>
                            <p class="terminos">Esta pol铆tica de privacidad describe c贸mo recogemos, usamos y
                                compartimos tu informaci贸n personal.</p>
                            <h2 class="terminos">1. Informaci贸n que Recogemos</h2>
                            <p class="terminos">Recogemos informaci贸n que t煤 nos proporcionas al registrarte, como tu
                                nombre, correo electr贸nico, y otra informaci贸n relevante.</p>
                            <h2 class="terminos">2. Uso de la Informaci贸n</h2>
                            <p class="terminos">Usamos tu informaci贸n para ofrecerte nuestros servicios, comunicarnos
                                contigo, y mejorar nuestra plataforma.</p>
                            <h2 class="terminos">3. Compartir Informaci贸n</h2>
                            <p class="terminos">No vendemos ni compartimos tu informaci贸n personal con terceros sin tu
                                consentimiento, salvo por requisitos legales.</p>
                            <h2 class="terminos">4. Seguridad</h2>
                            <p class="terminos">Tomamos medidas razonables para proteger tu informaci贸n personal. Sin
                                embargo, no podemos garantizar la seguridad absoluta.</p>
                            <h2 class="terminos">5. Cambios a esta Pol铆tica</h2>
                            <p class="terminos">Nos reservamos el derecho de modificar esta pol铆tica de privacidad en
                                cualquier momento. Te notificaremos sobre cambios significativos.</p>
                            <h2 class="terminos">6. Contacto</h2>
                            <p class="terminos">Si tienes preguntas sobre esta pol铆tica, cont谩ctanos a trav茅s de nuestro
                                formulario de contacto.</p>
                            <h2 class="terminos">7. Cookies</h2>
                            <p class="terminos">Este sitio utiliza cookies para mejorar tu experiencia. Puedes gestionar
                                tus preferencias de cookies en la configuraci贸n de tu navegador.</p>
                            <h2 class="terminos">8. Derecho a Acceder y Rectificar</h2>
                            <p class="terminos">Tienes derecho a acceder, corregir o eliminar tu informaci贸n personal en
                                cualquier momento. Para hacerlo, cont谩ctanos.</p>
                            <h2 class="terminos">9. Retenci贸n de Datos</h2>
                            <p class="terminos">Retenemos tu informaci贸n personal solo durante el tiempo necesario para
                                cumplir con los prop贸sitos para los que fue recogida.</p>
                            <h2 class="terminos">10. Transferencias Internacionales</h2>
                            <p class="terminos">Si transferimos tu informaci贸n personal a otros pa铆ses, aseguraremos que
                                se apliquen medidas adecuadas de protecci贸n de datos.</p>
                            <h2 class="terminos">11. Menores de Edad</h2>
                            <p class="terminos">No recogemos intencionadamente informaci贸n de menores de 13 a帽os. Si
                                descubrimos que hemos recogido dicha informaci贸n, la eliminaremos.</p>
                            <h2 class="terminos">12. Quejas</h2>
                            <p class="terminos">Si tienes alguna queja sobre nuestra pol铆tica de privacidad o c贸mo
                                manejamos tu informaci贸n, puedes contactar con las autoridades competentes.</p>
                            <h2 class="terminos">13. Consentimiento</h2>
                            <p class="terminos">Al utilizar nuestro sitio, das tu consentimiento para la recopilaci贸n y
                                uso de tu informaci贸n como se describe en esta pol铆tica.</p>
                            <h2 class="terminos">14. Enlaces a Terceros</h2>
                            <p class="terminos">Nuestro sitio puede contener enlaces a otros sitios. No somos
                                responsables de las pr谩cticas de privacidad de estos sitios.</p>
                            <h2 class="terminos">15. Modificaciones a los T茅rminos</h2>
                            <p class="terminos">Cualquier modificaci贸n a esta pol铆tica se publicar谩 en esta p谩gina. Te
                                recomendamos revisarla regularmente.</p>
                        </div>
                    </div>

                    <h5>- RELLENE LOS DATOS REQUERIDOS PARA CONTINUAR</h5>
                    <button class="btn-detalles" id="btn-detalles" type="button" onclick="openPopup('yape-popup')"
                        disabled>Finalizar Compra</button>
                </form>
            </div>

            <!-- Resumen de la Compra -->
            <div class="order-summary">
                <h2>Resumen de la compra</h2>
                <!-- Aqu铆 se generar谩n los items del carrito -->
                <div id="summaryItems"></div>
                <div class="totales">
                    <!-- Secci贸n de totales y costo de env铆o -->
                    <p id="summaryTotal2">S/ 0.00</p>
                    <p id="costoImpuesto">IGV (5%): S/ 0.00</p>
                    <p id="costoEnvio">Costo de env铆o: S/ 0.00</p>
                    <div id="progress-container">
                        <div id="progress-bar"></div>
                    </div>
                    <p id="free-shipping-message" style="display: none;">ENVO GRATIS DISPONIBLE</p>
                    <p id="summaryTotalGeneral">Total S/ 0.00</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-top">
            <div class="footer-container">
                <div class="footer-column">
                    <h3 class="footer-title">Ubicaci贸n</h3>
                    <p class="footer-text">Mercado Sur 125,</p>
                    <p> Huacho 15136</p>
                </div>
                <div class="footer-column">
                    <h3 class="footer-title" id="contacto">Contacto</h3>
                    <p class="footer-text">Email: iepvillamar铆a@gmail.com</p>
                </div>
                <div class="footer-column">
                    <h3 class="footer-title">S铆guenos</h3>
                    <div class="social-links">
                        <a href="https://www.facebook.com/profile.php?id=61563910384955f" class="social-link"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://wa.link/r2qn7g" class="social-link" aria-label="Whatsapp"><i
                                class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3 class="footer-title">Calificaci贸n</h3>
                    <img src="img
/footer/Estrellas.webp" loading="lazy" alt="Estrellas" class="imagenes">
                </div>
                <div class="footer-column">
                    <h3 class="footer-title">Pagos</h3>
                    <div class="payment-methods">
                        <img src="img
/footer/visa.webp" alt="Visa" loading="lazy" class="payment-icon">
                        <img src="img
/footer/paypal.webp" alt="Paypal" loading="lazy" class="payment-icon">
                        <img src="img/footer/niubiz.avif" alt="Vende M谩s" loading="lazy" class="payment-icon">
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <p>&copy; 2024 I.E.P. VILLA MARA. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="js/JS - Usuario.js"></script>

    <!-- DESCUENTO -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let discount = 0; // Variable para almacenar el descuento temporal
            let couponApplied = false; // Estado para verificar si el cup贸n ya fue aplicado

            // Funci贸n para validar el cup贸n
            document.getElementById('validateCoupon').addEventListener('click', function () {
                if (couponApplied) {
                    // Si el cup贸n ya fue aplicado, muestra un mensaje y no hace nada
                    Swal.fire({
                        title: 'Cup贸n ya aplicado',
                        text: 'El cup贸n ya ha sido utilizado y no se puede aplicar nuevamente.',
                        icon: 'info', // Puedes cambiar a 'warning' si lo deseas
                        confirmButtonText: 'Entendido',
                        customClass: {
                            popup: 'swal2-popup-custom',
                            title: 'swal2-title-custom',
                            text: 'swal2-text-custom',
                            confirmButton: 'swal2-confirm-custom'
                        }
                    });
                    return; // Salir de la funci贸n
                }

                const couponInput = document.getElementById('coupon').value.trim(); // No convertir a may煤sculas, comparaci贸n estricta
                const discountRates = {
                    "FACEBOOK": 0.10, // 10% de descuento
                    "OFERTA": 0.15,  // 15% de descuento
                    "EDITORIALGRETHEL": 0.20 // 20% de descuento
                };

                // Obtener los elementos del total
                const summaryTotalElem1 = document.getElementById('summaryTotalGeneral');
                const summaryTotalElem2 = document.getElementById('summaryTotalGeneral2');

                // Comprobar si los elementos del total existen
                if (!summaryTotalElem1 || !summaryTotalElem2) {
                    console.error('Uno o m谩s elementos necesarios no se encontraron.');
                    return;
                }

                // Obtener el valor actual del total en summaryTotal1 y extraer el n煤mero
                const totalText1 = summaryTotalElem1.textContent;
                const totalMatch1 = totalText1.match(/S\/ (\d+(\.\d{2})?)/);
                let total1 = 0;

                if (totalMatch1) {
                    total1 = parseFloat(totalMatch1[1]);
                } else {
                    console.error('El formato del total en summaryTotal1 no es v谩lido.');
                    return;
                }

                // Obtener el valor actual del total en summaryTotal2 y extraer el n煤mero
                const totalText2 = summaryTotalElem2.textContent;
                const totalMatch2 = totalText2.match(/S\/ (\d+(\.\d{2})?)/);
                let total2 = 0;

                if (totalMatch2) {
                    total2 = parseFloat(totalMatch2[1]);
                } else {
                    console.error('El formato del total en summaryTotal2 no es v谩lido.');
                    return;
                }

                // Verificar si el cup贸n ingresado est谩 en la lista de c贸digos v谩lidos
                if (discountRates.hasOwnProperty(couponInput)) {
                    const discountRate = discountRates[couponInput]; // Obtener el porcentaje de descuento correspondiente

                    // Aplicar el descuento temporalmente
                    const newTotal1 = roundAmount(total1 * (1 - discountRate));
                    const newTotal2 = roundAmount(total2 * (1 - discountRate));

                    // Calcular el descuento aplicado
                    discount = roundAmount(total1 - newTotal1); // Calcula el descuento

                    // Actualizar los valores en la p谩gina
                    summaryTotalElem1.textContent = `Total: S/ ${newTotal1}`;
                    summaryTotalElem2.textContent = `S/ ${newTotal2}`;

                    // Mostrar mensaje de 茅xito
                    Swal.fire({
                        title: '隆Cup贸n aplicado!',
                        text: `Se ha aplicado un ${discountRate * 100}% de descuento.`,
                        icon: 'success',
                        confirmButtonText: '隆Genial!',
                        customClass: {
                            popup: 'swal2-popup-custom',
                            title: 'swal2-title-custom',
                            text: 'swal2-text-custom',
                            confirmButton: 'swal2-confirm-custom'
                        }
                    });

                    couponApplied = true; // Marcar como aplicado el cup贸n
                    document.getElementById('validateCoupon').disabled = true; // Deshabilitar el bot贸n
                } else {
                    // Si el cup贸n no es v谩lido, aseg煤rate de mostrar "S/0"
                    discount = 0; // Resetear el descuento
                    summaryTotalElem1.textContent = `Total: S/ 0`;
                    summaryTotalElem2.textContent = `S/ 0`;

                    Swal.fire({
                        title: 'Cup贸n inv谩lido',
                        text: 'El cup贸n que ingresaste no es v谩lido. Int茅ntalo de nuevo.',
                        icon: 'error',
                        confirmButtonText: 'Entendido',
                        customClass: {
                            popup: 'swal2-popup-custom',
                            title: 'swal2-title-custom',
                            text: 'swal2-text-custom',
                            confirmButton: 'swal2-confirm-custom'
                        }
                    });
                }
            });

            // Funci贸n para guardar el descuento cuando se hace clic en "FINALIZE-BTN"
            document.getElementById('finalize-btn').addEventListener('click', function () {
                // Guardar el descuento en localStorage para usarlo en otro HTML
                localStorage.setItem('appliedDiscount', discount);
            });

            // Funci贸n para redondear el monto
            function roundAmount(amount) {
                return Math.round(amount);
            }
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    const searchInput = document.getElementById('searchInput');
                    const dropdownMenu = document.getElementById('dropdownMenu');
                    let selectedDepartment = null;

                    function updateDropdown(results) {
                        dropdownMenu.innerHTML = results.map(result => {
                            return `<div class="dropdown-item" data-type="${result.type}" data-value="${result.value}">${result.value}</div>`;
                        }).join('');
                        dropdownMenu.style.display = results.length > 0 ? 'block' : 'none'; // Mostrar el men煤 solo si hay resultados
                    }

                    searchInput.addEventListener('input', function () {
                        const query = searchInput.value.trim().toLowerCase();
                        dropdownMenu.innerHTML = ''; // Limpiar el men煤

                        if (query.length >= 3) {
                            const results = [];

                            // Filtrar departamentos
                            for (const department in data.departamentos) {
                                if (department.toLowerCase().includes(query)) {
                                    results.push({ type: 'department', value: department });
                                }
                            }

                            // Filtrar provincias y distritos basados en el departamento seleccionado
                            if (selectedDepartment) {
                                const deptData = data.departamentos[selectedDepartment];
                                Object.keys(deptData.distritos).forEach(province => {
                                    if (province.toLowerCase().includes(query)) {
                                        results.push({ type: 'province', value: province });
                                    }
                                    deptData.distritos[province].forEach(district => {
                                        if (district.toLowerCase().includes(query)) {
                                            results.push({ type: 'district', value: district });
                                        }
                                    });
                                });
                            }

                            // Mostrar resultados
                            if (results.length > 0) {
                                updateDropdown(results);
                            }
                        } else {
                            dropdownMenu.style.display = 'none'; // Ocultar el men煤 si el texto es menor a 3 caracteres
                        }
                    });

                    dropdownMenu.addEventListener('click', function (e) {
                        if (e.target.classList.contains('dropdown-item')) {
                            const type = e.target.getAttribute('data-type');
                            const value = e.target.getAttribute('data-value');

                            if (type === 'department') {
                                selectedDepartment = value;
                                searchInput.value = value;
                                // Actualizar men煤 para mostrar provincias y distritos
                                const deptData = data.departamentos[selectedDepartment];
                                const provinces = Object.keys(deptData.distritos).map(province => ({ type: 'province', value: province }));
                                const districts = [];
                                Object.values(deptData.distritos).forEach(districtArray => {
                                    districtArray.forEach(district => {
                                        districts.push({ type: 'district', value: district });
                                    });
                                });
                                updateDropdown([...provinces, ...districts]);
                            } else {
                                searchInput.value = value;
                                dropdownMenu.style.display = 'none'; // Ocultar men煤 despu茅s de selecci贸n
                            }
                        }
                    });
                })
                .catch(error => console.error('Error al cargar el archivo JSON:', error));
        });
    </script>

    <!-- Code injected by live-server -->
    <script>
        // <![CDATA[  <-- For SVG support
        if ('WebSocket' in window) {
            (function () {
                function refreshCSS() {
                    var sheets = [].slice.call(document.getElementsByTagName("link"));
                    var head = document.getElementsByTagName("head")[0];
                    for (var i = 0; i < sheets.length; ++i) {
                        var elem = sheets[i];
                        var parent = elem.parentElement || head;
                        parent.removeChild(elem);
                        var rel = elem.rel;
                        if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
                            var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
                            elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
                        }
                        parent.appendChild(elem);
                    }
                }
                var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
                var address = protocol + window.location.host + window.location.pathname + '/ws';
                var socket = new WebSocket(address);
                socket.onmessage = function (msg) {
                    if (msg.data == 'reload') window.location.reload();
                    else if (msg.data == 'refreshcss') refreshCSS();
                };
                if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
                    console.log('Live reload enabled.');
                    sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
                }
            })();
        }
        else {
            console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
        }
        // ]]>
    </script>

    <script>
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}-${month}-${year}`;
        }

        function updateDeliveryDates1() {
            const currentDate1 = new Date();
            const endDate1 = new Date(currentDate1);
            endDate1.setDate(currentDate1.getDate() + 3);

            document.getElementById('start-date1').textContent = formatDate(currentDate1);
            document.getElementById('end-date1').textContent = formatDate(endDate1);
        }

        function updateDeliveryDates2() {
            const currentDate2 = new Date();
            const endDate2 = new Date(currentDate2);
            endDate2.setDate(currentDate2.getDate() + 3);

            document.getElementById('start-date2').textContent = formatDate(currentDate2);
            document.getElementById('end-date2').textContent = formatDate(endDate2);
        }

        function updateDeliveryDates3() {
            const currentDate3 = new Date();
            const endDate3 = new Date(currentDate3);
            endDate3.setDate(currentDate3.getDate() + 3);

            document.getElementById('start-date3').textContent = formatDate(currentDate3);
            document.getElementById('end-date3').textContent = formatDate(endDate3);
        }

        // Llamando a las funciones para actualizar las 3 fechas
        updateDeliveryDates1();
        updateDeliveryDates2();
        updateDeliveryDates3();
    </script>

    <script>

        function validateForm() {
            const operacion = document.getElementById('operacion').value;
            const confirmaOperacion = document.getElementById('confirma-operacion').value;
            const errorMessage = document.getElementById('error-message');

            if (operacion !== confirmaOperacion) {
                errorMessage.textContent = "N煤mero de Operaci贸n diferente, revise de nuevo.";
            } else {
                errorMessage.textContent = "";
            }
        }
    </script>

    <script>
        // Obtener el DNI guardado del localStorage
        const loggedInDNI = localStorage.getItem("loggedInDNI");

        // Obtener los usuarios del localStorage
        const existingUsers = JSON.parse(localStorage.getItem("users")) || [];

        // Buscar el usuario basado en el DNI
        const user = existingUsers.find(user => user.dni === loggedInDNI);

        // Mostrar la informaci贸n del usuario
        if (loggedInDNI) {
            document.getElementById("userDNI").textContent = loggedInDNI;
            if (user) {
                document.getElementById("userNames").textContent = `${user.firstName} ${user.lastName}`;
                document.getElementById("userEmail").textContent = user.email;
                document.getElementById("userPhone").textContent = user.phone;
            } else {
                document.getElementById("userNames").textContent = "No se encontr贸 el usuario.";
            }
        } else {
            document.getElementById("userDNI").textContent = "No has iniciado sesi贸n.";
            document.getElementById("userNames").textContent = "";
            document.getElementById("userEmail").textContent = "";
            document.getElementById("userPhone").textContent = "";
        }

        /* ------------------------CERRAR SESIN------------------------ */

        document.getElementById("logoutButton").addEventListener("click", function () {
            // Verificar si hay un DNI en localStorage
            const loggedInDNI = localStorage.getItem("loggedInDNI");

            if (loggedInDNI) {
                // Eliminar el DNI de localStorage (cerrar sesi贸n)
                localStorage.removeItem("loggedInDNI");
                alert("Has cerrado sesi贸n.");
                // Redirigir a la p谩gina de inicio
                window.location.href = "/"; // Cambia a la ruta de tu p谩gina de inicio
            } else {
                // Si no est谩 logueado, redirigir a la p谩gina principal
                window.location.href = "/";
            }
        });
    </script>

    <!-- TERMINOS Y CONDICIONES -->

    <script>
        // Obtener los elementos del modal y los botones
        var termsModal = document.getElementById("termsModal");
        var privacyModal = document.getElementById("privacyModal");
        var openTermsModal = document.getElementById("openTermsModal");
        var openPrivacyModal = document.getElementById("openPrivacyModal");
        var closeTerms = document.getElementById("closeTerms");
        var closePrivacy = document.getElementById("closePrivacy");

        // Funci贸n para abrir el modal de t茅rminos y condiciones
        openTermsModal.onclick = function (event) {
            event.preventDefault(); // Evitar el comportamiento predeterminado del enlace
            termsModal.style.display = "block"; // Mostrar el modal
        };

        // Funci贸n para abrir el modal de pol铆tica de privacidad
        openPrivacyModal.onclick = function (event) {
            event.preventDefault(); // Evitar el comportamiento predeterminado del enlace
            privacyModal.style.display = "block"; // Mostrar el modal
        };

        // Funci贸n para cerrar el modal de t茅rminos
        closeTerms.onclick = function () {
            termsModal.style.display = "none"; // Ocultar el modal
        };

        // Funci贸n para cerrar el modal de privacidad
        closePrivacy.onclick = function () {
            privacyModal.style.display = "none"; // Ocultar el modal
        };

        // Cerrar el modal si se hace clic fuera de 茅l
        window.onclick = function (event) {
            if (event.target == termsModal) {
                termsModal.style.display = "none";
            } else if (event.target == privacyModal) {
                privacyModal.style.display = "none";
            }
        };
    </script>

    <script>
        // Verificar si el usuario est谩 logueado antes de acceder a checkout.html
        window.onload = function () {
            const loggedInDNI = localStorage.getItem("loggedInDNI");
            if (!loggedInDNI) {
                // Si no est谩 logueado, mostrar un SweetAlert2
                Swal.fire({
                    title: 'Acceso Denegado',
                    text: 'Debes iniciar sesi贸n para acceder a la p谩gina de checkout.',
                    icon: 'warning',
                    confirmButtonText: 'Entendido'
                }).then(() => {
                    // Redirigir a la p谩gina de inicio de sesi贸n despu茅s de que el usuario haga clic en "Entendido"
                    window.location.href = "/"; // Cambia "login.html" por la p谩gina de login correspondiente
                });
            }
        };
    </script>

    <script src="js/JS - Checkout.js"></script>
    <script src="js/JS - Departamentos.js"></script>
    <script src="js/JS - Principal.js"></script>
    <script src="js/JS - Usuario.js"></script>

</body>
</html>
